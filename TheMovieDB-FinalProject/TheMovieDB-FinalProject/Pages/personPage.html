<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="personPage.css" rel="stylesheet" />
    <style>
        #personPic > img {
            height: 300px;
            width: 200px;
            float: left;
            padding-right: 15px;
        }

        .card {
            display: inline-block;
        }

        #tab > img {
            margin: 5px;
            padding: 5px;
            height: 200px;
            width: 10rem;
            float: left;
        }

    </style>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">

    <!-- JQuerry -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
            integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
            crossorigin="anonymous">
    </script>

    <!-- AJAX -->
    <script src="../Scripts/ajaxCalls.js"></script>

    <script>
        $(document).ready(function () {
            key = "d8484ecfbfb906740724a447b5d63b12";
            url = "https://api.themoviedb.org/";
            imagePath = "https://image.tmdb.org/t/p/w500";
            personId = 9280;
            getPerson(personId);

            $('#tabs').on('click', '.moviesTab', function () {
                getPersonMovies(personId);
            });

            $('#tabs').on('click', '.TvTab', function () {
                getPersonTv(personId);
            });
        });

        // Person --------------------------------------------------------------------

        {
            //--------------------------------------- GET -------------------------------------
            function getPerson(personId) {
                let apiCall = url + "3/person/" + personId + "?" + "api_key=" + key;

                ajaxCall("GET", apiCall, "", getPersonSuccessCB, getPersonErrorCB);
            }

            function getPersonSuccessCB(person) {
                $('#personPic').append('<img src="' + imagePath + person.profile_path + '"/>');
                $('#personName').append(person.name);
                $('#biography').append(person.biography);
                $('#known_for').append(person.known_for_department);
                if (person.gender == 1) { gender = 'female' } else gender = 'male';
                $('#gender').append(gender);
                $('#birthday').append(person.birthday);
                $('#place_of_birth').append(person.place_of_birth);
                getPersonMovies(personId);
            }

            function getPersonErrorCB(err) {
                console.log(err.status + " " + err.responseJSON.Message);
            }
        }

        // Person in movies --------------------------------------------------------------------

        {
            //--------------------------------------- GET -------------------------------------
            function getPersonMovies(personId) {
                let apiCall = url + "3/person/" + personId + "/movie_credits?" + "api_key=" + key;

                ajaxCall("GET", apiCall, "", getPersonInMovieSuccessCB, getPersonInMovieErrorCB);
            }

            function getPersonInMovieSuccessCB(movie) {
                $('#movies').addClass("active");
                $('#tab img').remove();
                movies = movie.cast
                for (let i = 0; i < movies.length; i++) {
                    $('#tab').append('<img class="card" src="' + imagePath + movies[i].poster_path + '"/>');
                }
            }

            function getPersonInMovieErrorCB(err) {
                console.log(err.status + " " + err.responseJSON.Message);
            }
        }

        // Person in Tv --------------------------------------------------------------------

        {
            //--------------------------------------- GET -------------------------------------
            function getPersonTv(personId) {
                let apiCall = url + "3/person/" + personId + "/tv_credits?" + "api_key=" + key;

                ajaxCall("GET", apiCall, "", getPersonInTvSuccessCB, getPersonInTvErrorCB);
            }

            function getPersonInTvSuccessCB(tv) {
                $('#movies').removeClass("active");
                $('#tv').addClass("active");
                $('#tab img').remove();
                 Tv = tv.cast
                for (let i = 0; i < Tv.length; i++) {
                    $('#tab').append('<img class="card" src="' + imagePath + Tv[i].poster_path + '"/>');
                }
            }

            function getPersonInTvErrorCB(err) {
                console.log(err.status + " " + err.responseJSON.Message);
            }
        }
    </script>
</head>
<body>
    <section id="content" class="container">
        <!-- Begin .page-heading -->
        <div class="page-heading">
            <div class="media clearfix">
                <div class="media-left" id="personPic"></div>
                <div class="media-body va-m">
                    <h2 class="media-heading" id="personName"></h2>
                    <p class="lead" id="biography"></p>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-4">
                <div class="panel">
                    <div class="panel-heading">
                        <span class="panel-title">About Me</span>
                    </div>
                    <div class="panel-body pb5">

                        <h6>Known for</h6>

                        <p class="text-muted" id="known_for"></p>

                        <hr class="short br-lighter">

                        <h6>Gender</h6>

                        <p class="text-muted" id="gender"></p>

                        <hr class="short br-lighter">

                        <h6>Birthday</h6>

                        <p class="text-muted pb10" id="birthday"></p>

                        <hr class="short br-lighter">

                        <h6>Place of birth</h6>

                        <p class="text-muted pb10" id="place_of_birth"></p>

                    </div>
                </div>
            </div>
            <div class="col-md-8">

                <div class="tab-block" id="tabs">
                    <ul class="nav nav-tabs">
                        <li id="movies">
                            <a href="#tab1" data-toggle="tab" class="moviesTab">Movies</a>
                        </li>
                        <li id="tv">
                            <a href="#tab1" data-toggle="tab" class="TvTab">Tv</a>
                        </li>
                    </ul>
                    <div class="tab-content p30" style="height: 730px;">
                        <div id="tab1" class="tab-pane active">
                            <div class="media mt25" id="tab"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</body>
</html>